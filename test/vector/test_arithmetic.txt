(*
 * $ cd <JiecLib Project Root>
 * $ jiecc ./test/vector/test_arithmetic.txt -I. -I./vendor/jiecunit/sys -I./vendor/jiecunit -D_TEST_ -o ./test/vector/test_arithmetic.xml -t omron
 *)
{#include <jiecunit.txt>}
{#include <vector/arithmetic.txt>}

{#ifdef _TEST_}
DEFINE_CONFIGURATION(
	_JIEC_TESTNAMES_LIST_(
		'test_vector_add',
		'test_vector_sub',
		'test_vector_scale',
		'test_vector_dot',
		'test_vector_negate',
		'test_vector_elementwise_mul',
		'test_vector_elementwise_div',
		'test_vector_linear_combination',
		'test_vector_equal'
	)
)
{#endif}

{#define EPS 1.0e-9}

TEST_S(test_vector_add)
	var
		a1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b1: array[0..2] of lreal := [4.0, 5.0, 6.0];
		r1: array[0..2] of lreal;
		a2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		b2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		r2: array[0..2] of lreal;
		a3: array[0..1] of lreal := [-1.0, -2.0];
		b3: array[0..1] of lreal := [3.0, 4.0];
		r3: array[0..1] of lreal;
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		b4: array[0..2] of lreal := [-1.5, 2.5, -3.0];
		r4: array[0..2] of lreal;
		a5: array[0..0] of lreal := [10.0];
		b5: array[0..0] of lreal := [5.0];
		r5: array[0..0] of lreal;
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		b6: array[0..1] of lreal := [3000.0, 4000.0];
		r6: array[0..1] of lreal;
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		b7: array[0..2] of lreal := [0.4, 0.5, 0.6];
		r7: array[0..2] of lreal;
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		b8: array[0..2] of lreal := [5.0, 0.0, -5.0];
		r8: array[0..2] of lreal;
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		b9: array[0..3] of lreal := [1.0, 1.0, 1.0, 1.0];
		r9: array[0..3] of lreal;
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		b10: array[0..3] of lreal := [-2.0, 4.0, -6.0, 8.0];
		r10: array[0..3] of lreal;	end
	{st}
	Vector_add(a:=a1, b:=b1, result:=r1);
	EXPECT_NEAR(5.0, r1[0], EPS);
	EXPECT_NEAR(7.0, r1[1], EPS);
	EXPECT_NEAR(9.0, r1[2], EPS);
	Vector_add(a:=a2, b:=b2, result:=r2);
	EXPECT_NEAR(0.0, r2[0], EPS);
	EXPECT_NEAR(0.0, r2[1], EPS);
	EXPECT_NEAR(0.0, r2[2], EPS);
	Vector_add(a:=a3, b:=b3, result:=r3);
	EXPECT_NEAR(2.0, r3[0], EPS);
	EXPECT_NEAR(2.0, r3[1], EPS);
	Vector_add(a:=a4, b:=b4, result:=r4);
	EXPECT_NEAR(0.0, r4[0], EPS);
	EXPECT_NEAR(0.0, r4[1], EPS);
	EXPECT_NEAR(0.0, r4[2], EPS);
	Vector_add(a:=a5, b:=b5, result:=r5);
	EXPECT_NEAR(15.0, r5[0], EPS);
	Vector_add(a:=a6, b:=b6, result:=r6);
	EXPECT_NEAR(4000.0, r6[0], EPS);
	EXPECT_NEAR(6000.0, r6[1], EPS);
	Vector_add(a:=a7, b:=b7, result:=r7);
	EXPECT_NEAR(0.5, r7[0], EPS);
	EXPECT_NEAR(0.7, r7[1], EPS);
	EXPECT_NEAR(0.9, r7[2], EPS);
	Vector_add(a:=a8, b:=b8, result:=r8);
	EXPECT_NEAR(0.0, r8[0], EPS);
	EXPECT_NEAR(0.0, r8[1], EPS);
	EXPECT_NEAR(0.0, r8[2], EPS);
	Vector_add(a:=a9, b:=b9, result:=r9);
	EXPECT_NEAR(8.0, r9[0], EPS);
	EXPECT_NEAR(9.0, r9[1], EPS);
	EXPECT_NEAR(10.0, r9[2], EPS);
	EXPECT_NEAR(11.0, r9[3], EPS);
	Vector_add(a:=a10, b:=b10, result:=r10);
	EXPECT_NEAR(0.0, r10[0], EPS);
	EXPECT_NEAR(0.0, r10[1], EPS);
	EXPECT_NEAR(0.0, r10[2], EPS);
	EXPECT_NEAR(0.0, r10[3], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_sub)
	var
		a1: array[0..2] of lreal := [5.0, 7.0, 9.0];
		b1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r1: array[0..2] of lreal;
		a2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		b2: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r2: array[0..2] of lreal;
		a3: array[0..1] of lreal := [-1.0, -2.0];
		b3: array[0..1] of lreal := [3.0, 4.0];
		r3: array[0..1] of lreal;
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		b4: array[0..2] of lreal := [-1.5, 2.5, -3.0];
		r4: array[0..2] of lreal;
		a5: array[0..0] of lreal := [10.0];
		b5: array[0..0] of lreal := [5.0];
		r5: array[0..0] of lreal;
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		b6: array[0..1] of lreal := [3000.0, 4000.0];
		r6: array[0..1] of lreal;
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		b7: array[0..2] of lreal := [0.4, 0.5, 0.6];
		r7: array[0..2] of lreal;
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		b8: array[0..2] of lreal := [5.0, 0.0, -5.0];
		r8: array[0..2] of lreal;
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		b9: array[0..3] of lreal := [1.0, 1.0, 1.0, 1.0];
		r9: array[0..3] of lreal;
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		b10: array[0..3] of lreal := [-2.0, 4.0, -6.0, 8.0];
		r10: array[0..3] of lreal;	end
	{st}
	Vector_sub(a:=a1, b:=b1, result:=r1);
	EXPECT_NEAR(4.0, r1[0], EPS);
	EXPECT_NEAR(5.0, r1[1], EPS);
	EXPECT_NEAR(6.0, r1[2], EPS);
	Vector_sub(a:=a2, b:=b2, result:=r2);
	EXPECT_NEAR(-1.0, r2[0], EPS);
	EXPECT_NEAR(-2.0, r2[1], EPS);
	EXPECT_NEAR(-3.0, r2[2], EPS);
	Vector_sub(a:=a3, b:=b3, result:=r3);
	EXPECT_NEAR(-4.0, r3[0], EPS);
	EXPECT_NEAR(-6.0, r3[1], EPS);
	Vector_sub(a:=a4, b:=b4, result:=r4);
	EXPECT_NEAR(3.0, r4[0], EPS);
	EXPECT_NEAR(-5.0, r4[1], EPS);
	EXPECT_NEAR(6.0, r4[2], EPS);
	Vector_sub(a:=a5, b:=b5, result:=r5);
	EXPECT_NEAR(5.0, r5[0], EPS);
	Vector_sub(a:=a6, b:=b6, result:=r6);
	EXPECT_NEAR(-2000.0, r6[0], EPS);
	EXPECT_NEAR(-2000.0, r6[1], EPS);
	Vector_sub(a:=a7, b:=b7, result:=r7);
	EXPECT_NEAR(-0.3, r7[0], EPS);
	EXPECT_NEAR(-0.3, r7[1], EPS);
	EXPECT_NEAR(-0.3, r7[2], EPS);
	Vector_sub(a:=a8, b:=b8, result:=r8);
	EXPECT_NEAR(-10.0, r8[0], EPS);
	EXPECT_NEAR(0.0, r8[1], EPS);
	EXPECT_NEAR(10.0, r8[2], EPS);
	Vector_sub(a:=a9, b:=b9, result:=r9);
	EXPECT_NEAR(6.0, r9[0], EPS);
	EXPECT_NEAR(7.0, r9[1], EPS);
	EXPECT_NEAR(8.0, r9[2], EPS);
	EXPECT_NEAR(9.0, r9[3], EPS);
	Vector_sub(a:=a10, b:=b10, result:=r10);
	EXPECT_NEAR(4.0, r10[0], EPS);
	EXPECT_NEAR(-8.0, r10[1], EPS);
	EXPECT_NEAR(12.0, r10[2], EPS);
	EXPECT_NEAR(-16.0, r10[3], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_scale)
	var
		a1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r1: array[0..2] of lreal;
		a2: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r2: array[0..2] of lreal;
		a3: array[0..1] of lreal := [-1.0, -2.0];
		r3: array[0..1] of lreal;
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		r4: array[0..2] of lreal;
		a5: array[0..0] of lreal := [10.0];
		r5: array[0..0] of lreal;
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		r6: array[0..1] of lreal;
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		r7: array[0..2] of lreal;
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		r8: array[0..2] of lreal;
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		r9: array[0..3] of lreal;
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		r10: array[0..3] of lreal;	end
	{st}
	Vector_scale(a:=a1, scalar:=2.0, result:=r1);
	EXPECT_NEAR(2.0, r1[0], EPS);
	EXPECT_NEAR(4.0, r1[1], EPS);
	EXPECT_NEAR(6.0, r1[2], EPS);
	Vector_scale(a:=a2, scalar:=0.0, result:=r2);
	EXPECT_NEAR(0.0, r2[0], EPS);
	EXPECT_NEAR(0.0, r2[1], EPS);
	EXPECT_NEAR(0.0, r2[2], EPS);
	Vector_scale(a:=a3, scalar:=3.0, result:=r3);
	EXPECT_NEAR(-3.0, r3[0], EPS);
	EXPECT_NEAR(-6.0, r3[1], EPS);
	Vector_scale(a:=a4, scalar:=-2.0, result:=r4);
	EXPECT_NEAR(-3.0, r4[0], EPS);
	EXPECT_NEAR(5.0, r4[1], EPS);
	EXPECT_NEAR(-6.0, r4[2], EPS);
	Vector_scale(a:=a5, scalar:=0.5, result:=r5);
	EXPECT_NEAR(5.0, r5[0], EPS);
	Vector_scale(a:=a6, scalar:=-1.0, result:=r6);
	EXPECT_NEAR(-1000.0, r6[0], EPS);
	EXPECT_NEAR(-2000.0, r6[1], EPS);
	Vector_scale(a:=a7, scalar:=10.0, result:=r7);
	EXPECT_NEAR(1.0, r7[0], EPS);
	EXPECT_NEAR(2.0, r7[1], EPS);
	EXPECT_NEAR(3.0, r7[2], EPS);
	Vector_scale(a:=a8, scalar:=0.1, result:=r8);
	EXPECT_NEAR(-0.5, r8[0], EPS);
	EXPECT_NEAR(0.0, r8[1], EPS);
	EXPECT_NEAR(0.5, r8[2], EPS);
	Vector_scale(a:=a9, scalar:=1.5, result:=r9);
	EXPECT_NEAR(10.5, r9[0], EPS);
	EXPECT_NEAR(12.0, r9[1], EPS);
	EXPECT_NEAR(13.5, r9[2], EPS);
	EXPECT_NEAR(15.0, r9[3], EPS);
	Vector_scale(a:=a10, scalar:=-0.25, result:=r10);
	EXPECT_NEAR(-0.5, r10[0], EPS);
	EXPECT_NEAR(1.0, r10[1], EPS);
	EXPECT_NEAR(-1.5, r10[2], EPS);
	EXPECT_NEAR(2.0, r10[3], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_dot)
	var
		a1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b1: array[0..2] of lreal := [4.0, 5.0, 6.0];
		a2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		b2: array[0..2] of lreal := [1.0, 2.0, 3.0];
		a3: array[0..1] of lreal := [-1.0, -2.0];
		b3: array[0..1] of lreal := [3.0, 4.0];
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		b4: array[0..2] of lreal := [-1.5, 2.5, -3.0];
		a5: array[0..0] of lreal := [10.0];
		b5: array[0..0] of lreal := [5.0];
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		b6: array[0..1] of lreal := [3000.0, 4000.0];
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		b7: array[0..2] of lreal := [0.4, 0.5, 0.6];
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		b8: array[0..2] of lreal := [5.0, 0.0, -5.0];
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		b9: array[0..3] of lreal := [1.0, 1.0, 1.0, 1.0];
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		b10: array[0..3] of lreal := [-2.0, 4.0, -6.0, 8.0];
		result: lreal;
	end
	{st}
	result := Vector_dot(a:=a1, b:=b1);
	EXPECT_NEAR(32.0, result, EPS);
	result := Vector_dot(a:=a2, b:=b2);
	EXPECT_NEAR(0.0, result, EPS);
	result := Vector_dot(a:=a3, b:=b3);
	EXPECT_NEAR(-11.0, result, EPS);
	result := Vector_dot(a:=a4, b:=b4);
	EXPECT_NEAR(-17.5, result, EPS);
	result := Vector_dot(a:=a5, b:=b5);
	EXPECT_NEAR(50.0, result, EPS);
	result := Vector_dot(a:=a6, b:=b6);
	EXPECT_NEAR(11000000.0, result, EPS);
	result := Vector_dot(a:=a7, b:=b7);
	EXPECT_NEAR(0.32, result, EPS);
	result := Vector_dot(a:=a8, b:=b8);
	EXPECT_NEAR(-50.0, result, EPS);
	result := Vector_dot(a:=a9, b:=b9);
	EXPECT_NEAR(34.0, result, EPS);
	result := Vector_dot(a:=a10, b:=b10);
	EXPECT_NEAR(-120.0, result, EPS);
	{end}
END_TEST_S

TEST_S(test_vector_negate)
	var
		a1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r1: array[0..2] of lreal;
		a2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		r2: array[0..2] of lreal;
		a3: array[0..1] of lreal := [-1.0, -2.0];
		r3: array[0..1] of lreal;
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		r4: array[0..2] of lreal;
		a5: array[0..0] of lreal := [10.0];
		r5: array[0..0] of lreal;
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		r6: array[0..1] of lreal;
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		r7: array[0..2] of lreal;
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		r8: array[0..2] of lreal;
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		r9: array[0..3] of lreal;
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		r10: array[0..3] of lreal;	end
	{st}
	Vector_negate(a:=a1, result:=r1);
	EXPECT_NEAR(-1.0, r1[0], EPS);
	EXPECT_NEAR(-2.0, r1[1], EPS);
	EXPECT_NEAR(-3.0, r1[2], EPS);
	Vector_negate(a:=a2, result:=r2);
	EXPECT_NEAR(0.0, r2[0], EPS);
	EXPECT_NEAR(0.0, r2[1], EPS);
	EXPECT_NEAR(0.0, r2[2], EPS);
	Vector_negate(a:=a3, result:=r3);
	EXPECT_NEAR(1.0, r3[0], EPS);
	EXPECT_NEAR(2.0, r3[1], EPS);
	Vector_negate(a:=a4, result:=r4);
	EXPECT_NEAR(-1.5, r4[0], EPS);
	EXPECT_NEAR(2.5, r4[1], EPS);
	EXPECT_NEAR(-3.0, r4[2], EPS);
	Vector_negate(a:=a5, result:=r5);
	EXPECT_NEAR(-10.0, r5[0], EPS);
	Vector_negate(a:=a6, result:=r6);
	EXPECT_NEAR(-1000.0, r6[0], EPS);
	EXPECT_NEAR(-2000.0, r6[1], EPS);
	Vector_negate(a:=a7, result:=r7);
	EXPECT_NEAR(-0.1, r7[0], EPS);
	EXPECT_NEAR(-0.2, r7[1], EPS);
	EXPECT_NEAR(-0.3, r7[2], EPS);
	Vector_negate(a:=a8, result:=r8);
	EXPECT_NEAR(5.0, r8[0], EPS);
	EXPECT_NEAR(0.0, r8[1], EPS);
	EXPECT_NEAR(-5.0, r8[2], EPS);
	Vector_negate(a:=a9, result:=r9);
	EXPECT_NEAR(-7.0, r9[0], EPS);
	EXPECT_NEAR(-8.0, r9[1], EPS);
	EXPECT_NEAR(-9.0, r9[2], EPS);
	EXPECT_NEAR(-10.0, r9[3], EPS);
	Vector_negate(a:=a10, result:=r10);
	EXPECT_NEAR(-2.0, r10[0], EPS);
	EXPECT_NEAR(4.0, r10[1], EPS);
	EXPECT_NEAR(-6.0, r10[2], EPS);
	EXPECT_NEAR(8.0, r10[3], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_elementwise_mul)
	var
		a1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b1: array[0..2] of lreal := [4.0, 5.0, 6.0];
		r1: array[0..2] of lreal;
		a2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		b2: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r2: array[0..2] of lreal;
		a3: array[0..1] of lreal := [-1.0, -2.0];
		b3: array[0..1] of lreal := [3.0, 4.0];
		r3: array[0..1] of lreal;
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		b4: array[0..2] of lreal := [-1.5, 2.5, -3.0];
		r4: array[0..2] of lreal;
		a5: array[0..0] of lreal := [10.0];
		b5: array[0..0] of lreal := [5.0];
		r5: array[0..0] of lreal;
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		b6: array[0..1] of lreal := [3.0, 4.0];
		r6: array[0..1] of lreal;
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		b7: array[0..2] of lreal := [0.4, 0.5, 0.6];
		r7: array[0..2] of lreal;
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		b8: array[0..2] of lreal := [5.0, 0.0, -5.0];
		r8: array[0..2] of lreal;
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		b9: array[0..3] of lreal := [1.0, 1.0, 1.0, 1.0];
		r9: array[0..3] of lreal;
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		b10: array[0..3] of lreal := [-2.0, 4.0, -6.0, 8.0];
		r10: array[0..3] of lreal;	end
	{st}
	Vector_elementwise_mul(a:=a1, b:=b1, result:=r1);
	EXPECT_NEAR(4.0, r1[0], EPS);
	EXPECT_NEAR(10.0, r1[1], EPS);
	EXPECT_NEAR(18.0, r1[2], EPS);
	Vector_elementwise_mul(a:=a2, b:=b2, result:=r2);
	EXPECT_NEAR(0.0, r2[0], EPS);
	EXPECT_NEAR(0.0, r2[1], EPS);
	EXPECT_NEAR(0.0, r2[2], EPS);
	Vector_elementwise_mul(a:=a3, b:=b3, result:=r3);
	EXPECT_NEAR(-3.0, r3[0], EPS);
	EXPECT_NEAR(-8.0, r3[1], EPS);
	Vector_elementwise_mul(a:=a4, b:=b4, result:=r4);
	EXPECT_NEAR(-2.25, r4[0], EPS);
	EXPECT_NEAR(-6.25, r4[1], EPS);
	EXPECT_NEAR(-9.0, r4[2], EPS);
	Vector_elementwise_mul(a:=a5, b:=b5, result:=r5);
	EXPECT_NEAR(50.0, r5[0], EPS);
	Vector_elementwise_mul(a:=a6, b:=b6, result:=r6);
	EXPECT_NEAR(3000.0, r6[0], EPS);
	EXPECT_NEAR(8000.0, r6[1], EPS);
	Vector_elementwise_mul(a:=a7, b:=b7, result:=r7);
	EXPECT_NEAR(0.04, r7[0], EPS);
	EXPECT_NEAR(0.10, r7[1], EPS);
	EXPECT_NEAR(0.18, r7[2], EPS);
	Vector_elementwise_mul(a:=a8, b:=b8, result:=r8);
	EXPECT_NEAR(-25.0, r8[0], EPS);
	EXPECT_NEAR(0.0, r8[1], EPS);
	EXPECT_NEAR(-25.0, r8[2], EPS);
	Vector_elementwise_mul(a:=a9, b:=b9, result:=r9);
	EXPECT_NEAR(7.0, r9[0], EPS);
	EXPECT_NEAR(8.0, r9[1], EPS);
	EXPECT_NEAR(9.0, r9[2], EPS);
	EXPECT_NEAR(10.0, r9[3], EPS);
	Vector_elementwise_mul(a:=a10, b:=b10, result:=r10);
	EXPECT_NEAR(-4.0, r10[0], EPS);
	EXPECT_NEAR(-16.0, r10[1], EPS);
	EXPECT_NEAR(-36.0, r10[2], EPS);
	EXPECT_NEAR(-64.0, r10[3], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_elementwise_div)
	var
		a1: array[0..2] of lreal := [4.0, 10.0, 18.0];
		b1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r1: array[0..2] of lreal;
		a2: array[0..2] of lreal := [0.0, 0.0, 0.0];
		b2: array[0..2] of lreal := [1.0, 2.0, 3.0];
		r2: array[0..2] of lreal;
		a3: array[0..1] of lreal := [-3.0, -8.0];
		b3: array[0..1] of lreal := [3.0, 4.0];
		r3: array[0..1] of lreal;
		a4: array[0..2] of lreal := [1.5, -2.5, 3.0];
		b4: array[0..2] of lreal := [0.5, -0.5, 1.5];
		r4: array[0..2] of lreal;
		a5: array[0..0] of lreal := [10.0];
		b5: array[0..0] of lreal := [5.0];
		r5: array[0..0] of lreal;
		a6: array[0..1] of lreal := [1000.0, 2000.0];
		b6: array[0..1] of lreal := [10.0, 20.0];
		r6: array[0..1] of lreal;
		a7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		b7: array[0..2] of lreal := [0.1, 0.2, 0.3];
		r7: array[0..2] of lreal;
		a8: array[0..2] of lreal := [-5.0, 0.0, 5.0];
		b8: array[0..2] of lreal := [5.0, 1.0, -5.0];
		r8: array[0..2] of lreal;
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		b9: array[0..3] of lreal := [1.0, 2.0, 3.0, 4.0];
		r9: array[0..3] of lreal;
		a10: array[0..3] of lreal := [2.0, -4.0, 6.0, -8.0];
		b10: array[0..3] of lreal := [2.0, -2.0, 3.0, -4.0];
		r10: array[0..3] of lreal;	end
	{st}
	Vector_elementwise_div(a:=a1, b:=b1, result:=r1);
	EXPECT_NEAR(4.0, r1[0], EPS);
	EXPECT_NEAR(5.0, r1[1], EPS);
	EXPECT_NEAR(6.0, r1[2], EPS);
	Vector_elementwise_div(a:=a2, b:=b2, result:=r2);
	EXPECT_NEAR(0.0, r2[0], EPS);
	EXPECT_NEAR(0.0, r2[1], EPS);
	EXPECT_NEAR(0.0, r2[2], EPS);
	Vector_elementwise_div(a:=a3, b:=b3, result:=r3);
	EXPECT_NEAR(-1.0, r3[0], EPS);
	EXPECT_NEAR(-2.0, r3[1], EPS);
	Vector_elementwise_div(a:=a4, b:=b4, result:=r4);
	EXPECT_NEAR(3.0, r4[0], EPS);
	EXPECT_NEAR(5.0, r4[1], EPS);
	EXPECT_NEAR(2.0, r4[2], EPS);
	Vector_elementwise_div(a:=a5, b:=b5, result:=r5);
	EXPECT_NEAR(2.0, r5[0], EPS);
	Vector_elementwise_div(a:=a6, b:=b6, result:=r6);
	EXPECT_NEAR(100.0, r6[0], EPS);
	EXPECT_NEAR(100.0, r6[1], EPS);
	Vector_elementwise_div(a:=a7, b:=b7, result:=r7);
	EXPECT_NEAR(1.0, r7[0], EPS);
	EXPECT_NEAR(1.0, r7[1], EPS);
	EXPECT_NEAR(1.0, r7[2], EPS);
	Vector_elementwise_div(a:=a8, b:=b8, result:=r8);
	EXPECT_NEAR(-1.0, r8[0], EPS);
	EXPECT_NEAR(0.0, r8[1], EPS);
	EXPECT_NEAR(-1.0, r8[2], EPS);
	Vector_elementwise_div(a:=a9, b:=b9, result:=r9);
	EXPECT_NEAR(7.0, r9[0], EPS);
	EXPECT_NEAR(4.0, r9[1], EPS);
	EXPECT_NEAR(3.0, r9[2], EPS);
	EXPECT_NEAR(2.5, r9[3], EPS);
	Vector_elementwise_div(a:=a10, b:=b10, result:=r10);
	EXPECT_NEAR(1.0, r10[0], EPS);
	EXPECT_NEAR(2.0, r10[1], EPS);
	EXPECT_NEAR(2.0, r10[2], EPS);
	EXPECT_NEAR(2.0, r10[3], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_linear_combination)
	var
		v1: array[0..1, 0..2] of lreal := [1.0, 2.0, 3.0, 4.0, 5.0, 6.0];
		c1: array[0..1] of lreal := [1.0, 1.0];
		r1: array[0..2] of lreal;
		v2: array[0..1, 0..2] of lreal := [1.0, 2.0, 3.0, 4.0, 5.0, 6.0];
		c2: array[0..1] of lreal := [2.0, -1.0];
		r2: array[0..2] of lreal;
		v3: array[0..1, 0..2] of lreal := [-1.0, -2.0, -3.0, 3.0, 4.0, 5.0];
		c3: array[0..1] of lreal := [1.0, 0.5];
		r3: array[0..2] of lreal;
		v4: array[0..1, 0..2] of lreal := [0.0, 0.0, 0.0, 1.0, 2.0, 3.0];
		c4: array[0..1] of lreal := [3.0, 4.0];
		r4: array[0..2] of lreal;
		v5: array[0..1, 0..2] of lreal := [1.5, -2.5, 3.0, -1.5, 2.5, -3.0];
		c5: array[0..1] of lreal := [1.0, 1.0];
		r5: array[0..2] of lreal;
		v6: array[0..1, 0..2] of lreal := [10.0, 20.0, 30.0, 1.0, 1.0, 1.0];
		c6: array[0..1] of lreal := [0.1, 5.0];
		r6: array[0..2] of lreal;
		v7: array[0..1, 0..2] of lreal := [2.0, -4.0, 6.0, -2.0, 4.0, -6.0];
		c7: array[0..1] of lreal := [-1.0, 1.0];
		r7: array[0..2] of lreal;
		v8: array[0..1, 0..2] of lreal := [7.0, 8.0, 9.0, 1.0, 1.0, 1.0];
		c8: array[0..1] of lreal := [1.5, -0.5];
		r8: array[0..2] of lreal;
		v9: array[0..1, 0..2] of lreal := [0.1, 0.2, 0.3, 0.4, 0.5, 0.6];
		c9: array[0..1] of lreal := [10.0, -2.0];
		r9: array[0..2] of lreal;
		v10: array[0..1, 0..2] of lreal := [-5.0, 0.0, 5.0, 5.0, 0.0, -5.0];
		c10: array[0..1] of lreal := [0.5, 0.5];
		r10: array[0..2] of lreal;	end
	{st}
	Vector_linear_combination(vectors:=v1, coefficients:=c1, result:=r1);
	EXPECT_NEAR(5.0, r1[0], EPS);
	EXPECT_NEAR(7.0, r1[1], EPS);
	EXPECT_NEAR(9.0, r1[2], EPS);
	Vector_linear_combination(vectors:=v2, coefficients:=c2, result:=r2);
	EXPECT_NEAR(-2.0, r2[0], EPS);
	EXPECT_NEAR(-1.0, r2[1], EPS);
	EXPECT_NEAR(0.0, r2[2], EPS);
	Vector_linear_combination(vectors:=v3, coefficients:=c3, result:=r3);
	EXPECT_NEAR(0.5, r3[0], EPS);
	EXPECT_NEAR(0.0, r3[1], EPS);
	EXPECT_NEAR(-0.5, r3[2], EPS);
	Vector_linear_combination(vectors:=v4, coefficients:=c4, result:=r4);
	EXPECT_NEAR(4.0, r4[0], EPS);
	EXPECT_NEAR(8.0, r4[1], EPS);
	EXPECT_NEAR(12.0, r4[2], EPS);
	Vector_linear_combination(vectors:=v5, coefficients:=c5, result:=r5);
	EXPECT_NEAR(0.0, r5[0], EPS);
	EXPECT_NEAR(0.0, r5[1], EPS);
	EXPECT_NEAR(0.0, r5[2], EPS);
	Vector_linear_combination(vectors:=v6, coefficients:=c6, result:=r6);
	EXPECT_NEAR(6.0, r6[0], EPS);
	EXPECT_NEAR(7.0, r6[1], EPS);
	EXPECT_NEAR(8.0, r6[2], EPS);
	Vector_linear_combination(vectors:=v7, coefficients:=c7, result:=r7);
	EXPECT_NEAR(-4.0, r7[0], EPS);
	EXPECT_NEAR(8.0, r7[1], EPS);
	EXPECT_NEAR(-12.0, r7[2], EPS);
	Vector_linear_combination(vectors:=v8, coefficients:=c8, result:=r8);
	EXPECT_NEAR(10.0, r8[0], EPS);
	EXPECT_NEAR(11.5, r8[1], EPS);
	EXPECT_NEAR(13.0, r8[2], EPS);
	Vector_linear_combination(vectors:=v9, coefficients:=c9, result:=r9);
	EXPECT_NEAR(0.2, r9[0], EPS);
	EXPECT_NEAR(1.0, r9[1], EPS);
	EXPECT_NEAR(1.8, r9[2], EPS);
	Vector_linear_combination(vectors:=v10, coefficients:=c10, result:=r10);
	EXPECT_NEAR(0.0, r10[0], EPS);
	EXPECT_NEAR(0.0, r10[1], EPS);
	EXPECT_NEAR(0.0, r10[2], EPS);
	{end}
END_TEST_S

TEST_S(test_vector_equal)
	var
		a1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b1: array[0..2] of lreal := [1.0, 2.0, 3.0];
		a2: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b2: array[0..2] of lreal := [1.00000000001, 1.99999999999, 3.0];
		a3: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b3: array[0..2] of lreal := [1.000001, 2.0, 3.0];
		a4: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b4: array[0..2] of lreal := [1.0005, 1.9995, 3.0004];
		a5: array[0..2] of lreal := [0.0, 0.0, 0.0];
		b5: array[0..2] of lreal := [0.0, 0.0, 0.0];
		a6: array[0..1] of lreal := [-1.0, -2.0];
		b6: array[0..1] of lreal := [-1.0, -2.0];
		a7: array[0..0] of lreal := [42.0];
		b7: array[0..0] of lreal := [42.0];
		a8: array[0..1] of lreal := [1.0, 2.0];
		b8: array[0..1] of lreal := [1.0, 2.0001];
		a9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0];
		b9: array[0..3] of lreal := [7.0, 8.0, 9.0, 10.0000000001];
		a10: array[0..2] of lreal := [1.0, 2.0, 3.0];
		b10: array[0..2] of lreal := [1.0, 2.0, 4.0];
		result: bool;
	end
	{st}
	result := Vector_equal(a:=a1, b:=b1);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a2, b:=b2);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a3, b:=b3);
	EXPECT_FALSE(result);
	result := Vector_equal(a:=a4, b:=b4, tolerance:=1.0e-3);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a5, b:=b5);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a6, b:=b6);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a7, b:=b7);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a8, b:=b8);
	EXPECT_FALSE(result);
	result := Vector_equal(a:=a9, b:=b9, tolerance:=1.0e-8);
	EXPECT_TRUE(result);
	result := Vector_equal(a:=a10, b:=b10);
	EXPECT_FALSE(result);
	{end}
END_TEST_S

{#undef EPS}
