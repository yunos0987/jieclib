(*
 * Test for Math_floor function
 * $ cd <JiecLib Project Root>
 * $ jiecc ./test/math/test_floor.txt -I./src -I./vendor/jiecunit/sys -I./vendor/jiecunit -o ./test/math/test_floor.xml -t omron
 * or
 * $ jiecc ./test/math/test_floor.txt -I./src -I./vendor/jiecunit/sys -I./vendor/jiecunit -o ./test/math/test_floor.xml -t keyence
 *)
{#include <jiecunit.txt>}
{#include <math/floor.txt>}

DEFINE_CONFIGURATION(
	_JIEC_TESTNAMES_LIST_(
		'test_floor'
	)
)

TEST_S(test_floor)
	{st}
	// 正の小数：小数部を切り捨て
	EXPECT_EQ_LREAL(2.0, Math_floor(x:=2.7));
	EXPECT_EQ_LREAL(3.0, Math_floor(x:=3.1));
	EXPECT_EQ_LREAL(5.0, Math_floor(x:=5.9));
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.5));

	// 負の小数：1引いた値
	EXPECT_EQ_LREAL(-3.0, Math_floor(x:=-2.7));
	EXPECT_EQ_LREAL(-4.0, Math_floor(x:=-3.1));
	EXPECT_EQ_LREAL(-6.0, Math_floor(x:=-5.9));
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.5));

	// 整数：そのまま返す
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.0));
	EXPECT_EQ_LREAL(5.0, Math_floor(x:=5.0));
	EXPECT_EQ_LREAL(10.0, Math_floor(x:=10.0));
	EXPECT_EQ_LREAL(-5.0, Math_floor(x:=-5.0));
	EXPECT_EQ_LREAL(-10.0, Math_floor(x:=-10.0));

	// 0と1の間の小数
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.1));
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.9));
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.99));

	// -1と0の間の小数
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.1));
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.9));
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.99));

	// 二桁小数（正の値）
	EXPECT_EQ_LREAL(2.0, Math_floor(x:=2.50));
	EXPECT_EQ_LREAL(2.0, Math_floor(x:=2.51));
	EXPECT_EQ_LREAL(2.0, Math_floor(x:=2.49));
	EXPECT_EQ_LREAL(3.0, Math_floor(x:=3.50));
	EXPECT_EQ_LREAL(3.0, Math_floor(x:=3.51));
	EXPECT_EQ_LREAL(3.0, Math_floor(x:=3.49));

	// 二桁小数（負の値）
	EXPECT_EQ_LREAL(-3.0, Math_floor(x:=-2.50));
	EXPECT_EQ_LREAL(-3.0, Math_floor(x:=-2.51));
	EXPECT_EQ_LREAL(-3.0, Math_floor(x:=-2.49));
	EXPECT_EQ_LREAL(-4.0, Math_floor(x:=-3.50));
	EXPECT_EQ_LREAL(-4.0, Math_floor(x:=-3.51));
	EXPECT_EQ_LREAL(-4.0, Math_floor(x:=-3.49));

	// 二桁小数（ゼロ近傍）
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.50));
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.51));
	EXPECT_EQ_LREAL(0.0, Math_floor(x:=0.49));
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.50));
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.51));
	EXPECT_EQ_LREAL(-1.0, Math_floor(x:=-0.49));

	// 二桁小数（大きな値）
	EXPECT_EQ_LREAL(100.0, Math_floor(x:=100.50));
	EXPECT_EQ_LREAL(100.0, Math_floor(x:=100.51));
	EXPECT_EQ_LREAL(100.0, Math_floor(x:=100.49));
	EXPECT_EQ_LREAL(-101.0, Math_floor(x:=-100.50));
	EXPECT_EQ_LREAL(-101.0, Math_floor(x:=-100.51));
	EXPECT_EQ_LREAL(-101.0, Math_floor(x:=-100.49));

	// 大きな値
	EXPECT_EQ_LREAL(100.0, Math_floor(x:=100.5));
	EXPECT_EQ_LREAL(1000.0, Math_floor(x:=1000.7));
	EXPECT_EQ_LREAL(-101.0, Math_floor(x:=-100.5));
	EXPECT_EQ_LREAL(-1001.0, Math_floor(x:=-1000.7));
	{end}
END_TEST_S
